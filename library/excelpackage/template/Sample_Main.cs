/*
 * Sample code demonstrating how to generate Excel spreadsheets on the server using 
 * Office Open XML and the ExcelPackage wrapper classes.
 * 
 * ExcelPackage provides server-side generation of Excel 2007 spreadsheets.
 * See http://www.codeplex.com/ExcelPackage for details.
 * 
 * Sample 1: Creates a basic workbook from scratch.
 * Sample 2: Reads a column of data from the spreadsheet generated by Sample 1
 * Sample 3: Creates a workbook based on a template and populates using the database data.
 * 
 * To run these samples you first need to download the binary version of the 
 * ExcelPackage assembly and register it in the GAC.
 * You can do this using the GacReg.bat batch file provided with the ExcelPackage binary.  
 * Alternatively you can modify the ExcelPackageSample project to reference 
 * the ExcelPackage.dll in its current location.
 * 
 * You will also need the the .NET Framework 3.0 installed. This can be obtained from 
 * http://www.microsoft.com/downloads/details.aspx?familyid=10CC340B-F857-4A14-83F5-25634C3BF043&displaylang=en
 * 
 * To run sample 3, you need to have the AdventureWorks database installed.
 * Modify the sample code so that it contains the connection string for your copy
 * of the AdventureWorks database!
 * If you do not have the AdventureWorks database you can download it from 
 * http://www.microsoft.com/downloads/details.aspx?FamilyID=E719ECF7-9F46-4312-AF89-6AD8702E4E6E&displaylang=en
 * Alternatively you can hack the code and insert your own SQL query.  
 * 
 * Copyright 2007 © Dr John Tunnicliffe 
 * mailto:dr.john.tunnicliffe@btinternet.com
 * All rights reserved.
 * 
 * All code and executables are provided "as is" with no warranty either express or implied. 
 * The author accepts no liability for any damage or loss of business that this product may cause.
 */
using System;
using System.IO;

namespace ExcelPackageSamples
{
	class Sample_Main
	{
		static void Main(string[] args)
		{
			try
			{
				// change this line to contain the path to the 
				// installation folder for the sample project.
                DirectoryInfo outputDir = new DirectoryInfo(@"C:\Users\me2d09\Documents\Visual Studio 2008\Library\excelpackage\template");
				// The 'templates' folder should be below the installation folder.
				DirectoryInfo templateDir = new DirectoryInfo(outputDir.FullName + @"\templates\");

				if (!outputDir.Exists) throw new Exception("outputDir does not exist!");
				if (!templateDir.Exists) throw new Exception("templateDir does not exist!");

				// Sample 1 - simply creates a new workbook from scratch
				// containing a worksheet that adds a few numbers together 
				Console.WriteLine("Running sample 1");
				string output = Sample1.RunSample1(outputDir);
				Console.WriteLine("Sample 1 created: {0}", output);
				Console.WriteLine();

				// Sample 2 - simply reads some values from the file generated by sample 1
				// and outputs them to the console
				Console.WriteLine("Running sample 2");
				Sample2.RunSample2(output);
				Console.WriteLine();
				output = "";

				// Sample 3 - creates a workbook based on a template and 
				// populates using data from the AdventureWorks database
				// This sample requires the AdventureWorks database.  
				// Please edit the database connection string below BEFORE running the sample!
				//string connectionStr = @"server=YourServerName;database=AdventureWorks;Integrated Security=true;";
				Console.WriteLine("Running sample 3");
				output = Sample3.RunSample3(outputDir, templateDir, "a");
				Console.WriteLine("Sample 3 created: {0}", output);
				Console.WriteLine();
			}
			catch (Exception ex)
			{
				Console.WriteLine("Error: {0}", ex.Message);
			}
			Console.WriteLine();
			Console.WriteLine("Press the return key to exit...");
			Console.Read();

		}
	}
}
